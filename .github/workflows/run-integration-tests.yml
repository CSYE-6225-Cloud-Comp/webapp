name: Run Integration Tests
on: [pull_request]
jobs:
  install-mysql-server:
    runs-on: ubuntu-latest
    env:
      DB_HOST: ${{ secrets.ENV_VARIABLES.DB_HOST }}
      DB_PORT: ${{ secrets.ENV_VARIABLES.DB_PORT }}
      DB_USER: ${{ secrets.ENV_VARIABLES.DB_USER }}
      DB_PASSWORD: ${{ secrets.ENV_VARIABLES.DB_PASSWORD }}
      DB_SCHEMA: ${{ secrets.ENV_VARIABLES.DB_SCHEMA }}
      DB_DIALECT: ${{ secrets.ENV_VARIABLES.DB_DIALECT }}
      DB_TIMEZONE: ${{ secrets.ENV_VARIABLES.DB_TIMEZONE }}
    steps:
      - name: Set up MySQL
        run: |
         sudo /lib/systemd/systemd-sysv-install enable mysql
         sudo systemctl enable mysql.service
         sudo systemctl start mysql.service
         sudo systemctl status mysql.service
         sudo mysql --user=$DB_USER --password=$DB_PASSWORD -e "CREATE DATABASE $DB_SCHEMA"

      - uses: actions/checkout@v4
      - uses: actions/setup-node@v3
        with:
          node-version: '18.x'
      - run: npm install
      - run: npm test
      - run: echo "Integration tests passed successfully!"
          
      
